function all_footprints_colored(footprint_mtx, cell_regist_mtx)
% plots footprints for all probes colored according to which probe
%
% try aligned_data_struct.spatial_footprints_corrected for spatial
% footprints
%

figure; hold on

% colors
%{
all_bcolors = [097 191 050; ...
               186 041 041; ...
               051 153 255; ...
               255 128 000; ...
               143 020 181; ...
               249 221 037; ...
               204 000 102; ...
               120 120 120];
all_bcolors = all_bcolors./255;
%}
%all_bcolors = distinguishable_colors(size(cell_regist_mtx,2));
%all_bcolors = parula(size(cell_regist_mtx,2));
%{
all_bcolors = [096 096 096; ...
               219 200 064; ...
               232 116 000; ...
               186 041 041; ...
               065 229 186; ...
               044 198 066; ...
               028 142 022; ...
               132 132 255; ...
               082 106 206; ...
               008 094 127; ...
               188 034 184; ...
               234 033 196; ...
               247 092 140; ...
               241 247 011; ...
               217 247 040; ...
               153 232 015; ...
               021 238 249; ...
               022 178 247; ...
               027 027 237; ...
               0 0 0]./255;
%}
all_bcolors = hsv(20);


% session order
session_order = [1 9 15 2 10 16 3 11 17 4 12 18 5 13 19 6 14 20 7 8];
cell_regist_mtx = cell_regist_mtx(:,session_order);
footprint_mtx = footprint_mtx(session_order);


% session plotting coordinates
yspace = 275;
spc = ...
[0 0; 200 -1*yspace; 200 -2*yspace; ...
400 0; 600 -1*yspace; 600 -2*yspace; ...
800 0; 1000 -1*yspace; 1000 -2*yspace; ...
1200 0; 1400 -1*yspace; 1400 -2*yspace; ...
1600 0; 1800 -1*yspace; 1800 -2*yspace; ...
2000 0; 2200 -1*yspace; 2200 -2*yspace; ...
2400 0; 2800 0];


% plot
for icell = 1:size(cell_regist_mtx,1)
        
    plot_color = all_bcolors(find(cell_regist_mtx(icell,:)>0, 1, 'first'),:);
    
    for isesh = 1:size(cell_regist_mtx,2)
        
        current_cell = cell_regist_mtx(icell,isesh);
        
        if current_cell==0
            continue
        end
        
        if isesh == find(cell_regist_mtx(icell,:)>0, 1, 'first')
        
            trace_footprint(squeeze(footprint_mtx{isesh}(current_cell,:,:)), plot_color, spc(isesh,1), spc(isesh,2));
            
        else
            
            trace_footprint(squeeze(footprint_mtx{isesh}(current_cell,:,:)), [.8 .8 .8], spc(isesh,1), spc(isesh,2));
            
        end

    end
    
end


% aesthetics
axis normal
axis on
axis auto
set(gca,'TickLength',[0, 0]); box off;
set(gca, 'YDir','normal')
set(gcf, 'Position', [217         881        1786         428])
title('Unique session color')


